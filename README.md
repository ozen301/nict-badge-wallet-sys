# NICT Badge & Wallet System

This repository implements the **Badge & Wallet System** for the NICT project carried out by Tohoku University. It manages NFT-based badges, bingo cards, and blockchain transactions.

## Project Structure

```
nict-badge-wallet-sys/
├─ nictbw/
│  ├─ blockchain/       # Blockchain API interaction
│  ├─ db/               # DB engine, session, metadata, utilities
│  ├─ models/           # SQLAlchemy ORM 2.0 models
├─ scripts/
│  ├─ init_db.py        # create all tables in local SQLite
│  └─ seed_dev.py       # seed dev data
├─ tests/               # unit tests
├─ .env                 # environment variables (not in repo)
├─ .env.example         # environment variables example
├─ README.md
└─ pyproject.toml
```

---

## Quick Start

### Prerequisites
- Python >= 3.10

### 1. Install the library (in editable mode)

```bash
pip install -e .
```

### 2. Configure .env file
Copy `.env.example` to `.env` and modify as needed.

### 3. Initialize the database

```bash
python scripts/init_db.py
python scripts/seed_dev.py  # optional, seed dev data
```

This creates `dev.db` (SQLite) with all schema objects.

### 4. Verify tables

The init script will print all created tables:

```
Created tables: admins, users, nft_conditions, nfts, user_nft_ownership, bingo_cards, bingo_cells, blockchain_transactions, audit_logs
```

---

## Run Tests (for Development)

The repository includes unit tests (generated by Codex) under `tests/` using Python's built-in `unittest`.

Run all tests:
```bash
cd tests
python -m unittest -v
```

Run specific tests/files:
```bash
cd tests
python -m unittest -v test_db_utils test_models
```


## Switching Databases

Change the `DB_URL` in `.env`:

```python
DB_URL="sqlite:///./dev.db"  # SQLite by default
```

Any URL supported by SQLAlchemy is valid here.

---

## TODO
* Add methods for querying and updating entities.
* Add bingo card generator that randomizes NFT assignments to cells.
* Include NFT metadata in blockchain related operations.
* Update module imports to Python package style.
* Confirmation on format of unique_nft_id.
* Integrate with App API.
* Add Alembic.
---
